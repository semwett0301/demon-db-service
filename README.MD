# DemonService

## Описание проекта

### Предметная область
#### Обзор
Процент атеистов с каждым годом на планете только увеличивается, но немногие из людей догадываются о посмертной системе распределения, после прохождения которой наиболее вероятно ВАС ЖДЕТ АД.

Ведь после смерти все души вне зависимости от пола, сексуальных предпочтений, гендерной принадлежности и прочих не имеющих значения факторов попадают в самую длинную очередь на свете. В конце очереди их ждет комиссия системы распределения. Ее состав практически неизменен и обновляется исключительно божественными силами. Члены комиссии ничего не требуют за свою работу, кроме криков грешников, которых пытают черти.

Основной задачей системы распределения является подсчет количества грешных и праведных дел, совершенных за период последней жизни, для классификации души. После классификации душа либо отправляется назад в обычный мир (возможно, в другом виде), либо в ад, где она будет распределена между несколькими чертями.

Каждый черт создан, чтобы унижать грешников, и имеет свою специализацию, которую получает при создании. Каждый грешник может стать чертом после определенного количества времени. После нескольких лет нахождения в аду черти получают право на реинкарнацию и отправляются в обычный мир.

Население планеты пополняется за счет перераспределенных и новорожденных душ. Каждый год возможны три события: несколько душ умерли, несколько душ появились на свет, несколько душ были повторно перераспределены в обычный мир.

#### Жизнь в обычном мире
В обычном мире изначально проживает опреденное количество людей. Они умирают каждый год, тем самым уменьшая популяцию. Часть из умерших людей после прохождения очереди на распределение возвращаются в обычный мир.

Демографический кризис в обычном мире не возникает из-за того, что ежегодно каждая женщина в паре с мужчиной рожает людей.

При реинкарнации и рождении людям назначаются случайные характеристики, которые влияют на их дальнейшее поведение в аду и в обычном мире (в частности, пол).

Кроме того, ежегодно каждый живой человек совершает греховные и праведные дела, которые будут учитываться после его смерти при распределении (каждое праведное и греховное дело имеет свой вес).

Если популяция людей слишком сильно разрастается, то божественные силы могут устроить геноцид по одной из характеристик людей (или по нескольким сразу).

#### Система распределения
Система распределения состоит из двух элементов: очереди умерших людей и комиссии распределения. Божественные силы могут уменьшать и увеличивать количество распредилителей (при этом распределители получают случайные характеристики оценки греховности и праведности умершего).

Каждый распределитель потребляет оры, создаваемые грешниками, которых пытают черти. Если распределителям не хватает оров, то у них происходит нервный срыв и вся очередь, вне зависимости от соотношения грехов и праведных дел, отправляется в АД.

Каждый год один распределитель оценивает одного умершего и отправляет его туда, куда посчитает нужным.

Помимо прочего, каждый распределитель обладает уникальными навыками, которые и требуют оры грешников.

#### Жизнь в аду
После попадания в ад, человек становится грешником и в зависимости от уровня его греховности его унижают n-е количество чертей. Если человек попал в ад из-за нервного срыва распределителей, то его унижает только один черт.

После проходения определеного периода времени часть грешников становятся чертями, а часть чертей реинкарнируют в обычный мир.

Каждый унижаемый грешник производит оры, которыми питаются распределители. Чем больше чертей унижают грешника, тем больше оров он производит.

Если божественная сущность считает чертей, которые должны быть реинкарнированны в ближайшее время, достойными, то он может их досрочно амнистировать и отправить в обычный мир.



### Бизнес-процессы, реализуемые приложением

1. Бизнес-процессы божественных сил:
   1. увеличение количества распределителей
   2. уменьшение количества распределителей
   3. проведение геноцида в обычном мире
   4. амнистирование чертей в аду
2. Бизнес-процессы в обычном мире:
   1. смерть случайных людей
   2. рождение людей от пары женщины и мужчины
   3. реинкарнация людей из ада или из системы распределения
   4. совершение греховных и праведных дел живыми людьми
3. Бизнес-процессы в системе распределения:
   1. распределение умерших в зависимости от соотношения их греховности и праведности
   2. распределение умерших в ад при стрессе распределителей
   3. потребление распределителями оров грешников
4. Бизнес-процессы в аду:
   1. становление человека грешником
   2. распределения чертей на грешника
   3. становление грешника чертом
   4. перераспределение черта на реинкарнацию
   5. производство грешниками оров

### Структура проекта

- ***server*** - серверная часть приложения
  - *resources* - мета-информация для запуска проекта
  - *config* - конфигурация фильтров
  - *controllers* - контроллеры MVC
  - *dto* - структуры данных, пересылаемые по HTTP
  - *entity* - структуры данных, описывающие сущности БД
  - *exceptions* - кастомные исключения
  - *repository* - JPA репозитории
  - *service* - сервисный слой приложения
- ***client*** - директория, содержащая клиенсткую часть приложения 
  - *public* - статика, собираемая в React приложение
  - *api* - модуль, содержащий взаимодействие с сервисным API
  - *components* - React компоненты, используемые в приложении
  - *context* - описание контекста React-приложения

### Структура API

### Изначальная структура БД
![](./img/db.png)

### Скрипт запуска
```
cd ./server
docker-compose up
./gradlew bootJar

cd ../client
npm i
npm start
```

## Планируемые изменения

### Этап 1. Рефакторинг клиентской части приложение 
1. Будет добавлен TypeScript в компоненты приложения
2. Будет добавлен eslint и prettier для создания единого code-style
3. Будет добавлен stylelint для создания единого code-style в css
4. Будет изменена структура проекта и добавлен именованный export:
   1. *components* - умные компоненты (составлены из атомарных)
   2. *panels* - страницы приложения
   3. *atom* - атомарные компоненты
   4. *api* - взаимодействие с API серверной части 
   5. *types* - типы для API и внутри приложения
   6. *context* - контекст React приложения
6. Будет изменена сетка футера приложения\
![](./img/footer.png)
7. Будет удалено лишнее логирование
### Этап 2. Рефакторинг серверной части приложения
1. API будет приведен в соотвествие с REST Name Convention
2. Будет изменены файлы контроллеров
3. Будет изменена клиентская часть в соотвествии с новым API
4. Будет изменена БД:
   1. Будет удалена сущность DemonSpecialization
   2. Будет изменена сущность Demon
5. Будет изменена политика CORS на более безопасную
6. Будут добавлены интерфейсы для сервисов
7. Конфигурация приложения будет переведена на yaml
8. Будет добавлена сортировка дистрибьютеров на клиенте

### Этап 3. Создание документации приложения
1. Будет добавлен Swagger UI для API
2. Будет добавлен Storybook для атомарных компонентов, используемых во frontend-части
3. Readme-файлы каждой из частей приложения будут заполнены корректной информацией
4. Будут добавлены комментарии к основным частям приложения
